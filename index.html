<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å»ƒæ£„å¯¾è±¡æ—¥ç¢ºèªWeb</title>
<style>
body {
  font-family: sans-serif;
  margin: 40px;
  background: #f9f9f9;
}
h1 {
  text-align: center;
  margin-bottom: 10px;
}
#today {
  text-align: center;
  font-size: 1.1em;
  margin-bottom: 10px;
}
button {
  display: block;
  margin: 10px auto;
  padding: 8px 16px;
  font-size: 1em;
  border: none;
  border-radius: 6px;
  background-color: #0078d4;
  color: white;
  cursor: pointer;
  transition: background-color 0.2s;
}
button:hover {
  background-color: #005fa3;
}
table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 20px;
  background: white;
  box-shadow: 0 0 6px rgba(0,0,0,0.1);
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}
th {
  background-color: #eee;
}

/* æ›´æ–°æƒ…å ±ãƒœãƒƒã‚¯ã‚¹ */
#update-info {
  margin-top: 40px;
  padding: 16px;
  background: #fff;
  border-left: 6px solid #0078d4;
  box-shadow: 0 0 6px rgba(0,0,0,0.1);
}
#update-info h2 {
  margin-top: 0;
}
.update-item {
  margin-bottom: 10px;
}
.update-date {
  color: #0078d4;
  font-weight: bold;
}
</style>
</head>
<body>

<h1>å»ƒæ£„å¯¾è±¡æ—¥ç¢ºèªWeb</h1>

<div id="today"></div>
<button onclick="reloadPage()">ğŸ”„ æœ¬æ—¥ã®æƒ…å ±ã‚’å†èª­ã¿è¾¼ã¿</button>

<table>
  <thead>
    <tr>
      <th>åŒºåˆ†</th>
      <th>å»ƒæ£„å¯¾è±¡æ—¥ï¼ˆç¯„å›²ï¼‰</th>
      <th>å»ƒæ£„å¯¾è±¡ã¨ãªã‚‹æ¶ˆè²»æœŸé™</th>
    </tr>
  </thead>
  <tbody id="result"></tbody>
</table>

<!-- â–¼ æ›´æ–°æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
<div id="update-info">
  <h2>ğŸ“¢ æ›´æ–°æƒ…å ±</h2>
  <div id="updates">èª­ã¿è¾¼ã¿ä¸­...</div>
</div>

<script>
function formatDate(date) {
  const y = date.getFullYear();
  const m = String(date.getMonth() + 1).padStart(2, '0');
  const d = String(date.getDate()).padStart(2, '0');
  return `${y}/${m}/${d}`;
}

function addDays(date, days) {
  const d = new Date(date);
  d.setDate(d.getDate() + days);
  return d;
}

function showData() {
  const today = new Date();
  document.getElementById("today").innerHTML =
    `<strong>æœ¬æ—¥ï¼š</strong>${formatDate(today)}`;

  const table = document.getElementById("result");
  table.innerHTML = ""; // å‰å›ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢

  const data = [
    { k: "K-1", days: 0 },
    { k: "K-3", days: 2 },
    { k: "K-5", days: 4 },
    { k: "K-30", days: 29 }
  ];

  data.forEach(item => {
    const start = formatDate(today);
    const end = formatDate(addDays(today, item.days));
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${item.k}</td>
      <td>${start} ï½ ${end}</td>
      <td>${item.days + 1}æ—¥ä»¥å†…</td>
    `;
    table.appendChild(row);
  });
}

function reloadPage() {
  location.reload(true);
}

// â–¼ update.jsonã‚’èª­ã¿è¾¼ã‚“ã§æ›´æ–°æƒ…å ±ã‚’è¡¨ç¤º
async function loadUpdates() {
  const updateDiv = document.getElementById("updates");
  try {
    const res = await fetch("update.json");
    if (!res.ok) throw new Error("update.json ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
    const updates = await res.json();

    updateDiv.innerHTML = "";
    updates.forEach(u => {
      const div = document.createElement("div");
      div.className = "update-item";
      div.innerHTML = `
        <div class="update-date">${u.date}</div>
        <div class="update-text">${u.text}</div>
      `;
      updateDiv.appendChild(div);
    });
  } catch (err) {
    updateDiv.innerHTML = `<span style="color:red;">æ›´æ–°æƒ…å ±ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸï¼š${err.message}</span>`;
  }
}

showData();
loadUpdates();
</script>

</body>
</html>
